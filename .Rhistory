}
}
}
return(pes)
}
neural()
s = c(0 , 0, 0, 1)
neural()
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = sum(ent[i])
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
return(pes)
}
neural()
ent[1]%*%pes[1]
ent[1]%*%pes[2]
step(ent[1]%*%pes[2])
step(ent[4]%*%pes[4])
pes[4]
pes[2]
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = sum(ent[i])
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
return(pes)
}
neural()
ent[1]
ent[1,1]
ent
ent[1,]
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = sum(ent[i, ])
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
return(pes)
}
neural()
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = step(ent[i, ]%*%pes)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
return(pes)
}
neural()
ent
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = step(ent[i, ]%*%pes)
e = abs(s[i] - s_cal)
e_t = e_t + e
print(e_t)
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
return(pes)
}
neural()
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = step(ent[i, ]%*%pes)
e = abs(s[i] - s_cal)
e_t = e_t + e
print(e_t)
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
#return(pes)
}
neural()
ent[4, ]%*%pes
ent[4, ]
s[4]
s[4] - scal
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_Cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
print(e_t)
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
#return(pes)
}
neural()
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
print(e_t)
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
#return(pes)
}
neural()
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
#return(pes)
}
neural()
#### Neural network
length(s)
for(i in length(s)){
print(i)
}
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
#return(pes)
}
neural()
for(i in 1:length(s)){
print(i)
}
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
#return(pes)
}
neural()
neural()
neural()
step(ent[1, ]%*%pes)
step(ent[2, ]%*%pes)
step(ent[-2, ]%*%pes)
step(-1)
ent[2, ]%*%pes
ent[1, ]%*%pes
step = function(soma){
if (soma>=1) {
return(1)
}else{
return(0)
}
}
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
#return(pes)
}
neural()
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
return(pes)
}
neural()
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
print(pes)
}
neural()
print('olá')
print('olá', 4)
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
print(s_cal)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
print('Os pesos são', pes)
}
neural()
print('pesos', pes)
print('pesos' pes)
print('pesos', 3)
cat('pesos', 3)
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
cat('Os pesos são', pes)
}
neural()
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
}
}
}
cat('Os pesos são':, pes)
}
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
print(e_t)
}
}
}
cat('Os pesos são':, pes)
}
neural = function(){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
}
}
}
cat('Os pesos são:', pes)
}
neural()
#***************************************************************************
#                          Neural Network
#****************************************************************************
e1 = c(0, 0)
e2 = c(0, 1)
e3 = c(1, 0)
e4 = c(1, 1)
ent = rbind(e1, e2, e3, e4)
pes = c(0, 0)
s = c(0 , 0, 0, 1)
step = function(soma){
if (soma>=1) {
return(1)
}else{
return(0)
}
}
#### Neural network
neural = function(apr){
e_t = 1
while(e_t !=0){
e_t = 0
for (i in 1:length(s)){
s_cal = step(ent[i, ]%*%pes)
e = abs(s[i] - s_cal)
e_t = e_t + e
for (j in 1:length(pes)) {
pes[j] = pes[j] + apr * ent[i, j] * e
}
}
}
cat('Os pesos são:', pes)
}
neural(0.1)
neural(0.2)
neural(0.3)
neural(1)
neural(0.2)
neural(0.1)
121 - 74
47*12.7
11.44*60 + 12.35*61 - 47*12.7 +74*12.55
-11.44*60 - 12.35*61 + 47*12.7 + 74*12.55
-8.39 *99 + 8.49*99
-7.94*100 + 8.12*100
-8.50*100 + 9.3*100
-17.79*6 + 19.5*6
85+85+9.9+18+10.26
-8.12*100+8.78*100
install.packages(ctv)
install.packages('ctv')
install.packages('moments')
x1 = c(2, 1, 5, 7, 8, 0, 2, 1)
x1 = c(2, 1, 5, 7, 8, 0, 2, 1)
l = 0.5
x = cbind(x1, x2)
x = cbind(x1, x2)
x2 = c(11, 2, 4, 5, 78, 1, 2, 9)
x2 = c(11, 2, 4, 5, 78, 1, 2, 9)
x2 = c(11, 2, 4, 5, 78, 1, 2, 9)
x = cbind(x1, x2)
l = 0.5
y = c(1, 5, 2, 3, 7, 32, 2, 0)
b = t(t(x)%*%x)%*%t(x)%*%
b = t(t(x)%*%x)%*%t(x)%*%y
b = t(t(x)%*%x)%*%t(x)%*%y
b
b = inv(t(x)%*%x)%*%t(x)%*%y
install.packages("matlib")
library(matlib)
b = inv(t(x)%*%x)%*%t(x)%*%y
b
b = inv(t(x)%*%x + l )%*%t(x)%*%y
b
b = inv(t(x)%*%x + 1000 )%*%t(x)%*%y
b
reg = lm(y ~x1 + x2)
summary(reg)
b = inv(t(x)%*%x)%*%t(x)%*%y
b
reg = lm(y ~x1 + x2 - 1)
summary(reg)
b
137-133.89
133.189-138.5
-133.189+138.5
(-133.189+138.5)*5
(-133.189+138.99)*5
(16-4.8)/4.8
4.8/16
0.7*16
16-11.2
4.8*0.7
4.8*1.7
16/4.8
25.5/669.45
100*(25.5/669.45)
#***********************************************************************************
#                             Neural Networks
#***********************************************************************************
setwd("D:/Git projects/ML in R")
library(rpart)
library(rpart.plot)
library(fBasics)
library(caTools)  # split data
library(caret)    #provide metrics for confusion matrix
# data
df = read.csv('credit.csv')
df$clientid = NULL
attach(df)
# drop na values
m_age = mean(age[age>0 ], na.rm = T)  # average without considering negative values
df$age = ifelse(df$age < 0 |is.na(df$age) , m_age, df$age)
# scaling data
df[, 1:3] = scale(df[, 1:3])
# Encode class
df$default = factor(df$default, levels = c(0,1))
# train and test
set.seed(1)
div = sample.split(df$income, SplitRatio = 0.75)
df_train = subset(df, div == TRUE)
df_test = subset(df, div == FALSE)
#---- Algorithm
library(neuralnet)
NN = neuralnet(default ~ income + loan + age, df_train, hidden = 3, linear.output = T)
# traçar rede neural
plot (NN)
prev2 = predict(NN, df_test[, -4])
